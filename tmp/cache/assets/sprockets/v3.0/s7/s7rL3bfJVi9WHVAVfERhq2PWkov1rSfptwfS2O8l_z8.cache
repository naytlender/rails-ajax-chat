I"-(function() {
  window.Poller = {
    poll: function(timeout) {
      if (timeout === 0) {
        return Poller.request();
      } else {
        clearTimeout(this.pollTimeout);
        return this.pollTimeout = setTimeout(function() {
          return Poller.request();
        }, timeout || 500);
      }
    },
    clear: function() {
      return clearTimeout(this.pollTimeout);
    },
    request: function() {
      var chatRoomId, last_id;
      chatRoomId = $('#messages').data('room-id');
      last_id = $('.message').last().data('id');
      if (chatRoomId > 0) {
        return $.get('/chat_rooms/' + chatRoomId + '/messages', {
          after_id: last_id
        });
      }
    }
  };

  jQuery(function() {
    if ($('#messages').length) {
      return Poller.poll();
    }
  });

}).call(this);
:ET